/* styles.css */
/* продолжаем */

/* ===============================
   Base / Tokens
=============================== */
:root{
  /* Calculator palette */
  --beige:#f8f5ef;
  --beige-2:#efe8da;
  --ink:#0f172a;
  --muted:#475569;
  --card:#ffffff;
  --line:#e7e2d8;
  --pill:#f2eadc;
  --btn:#1f2937;
  --btn-text:#fff;
  --radius:16px;
  --radius-sm:10px;
  --shadow:0 4px 18px rgba(0,0,0,.06);

  /* Catalog accents */
  --status-ok-bg:#d1fae5;  --status-ok-ink:#065f46;
  --status-warn-bg:#fef3c7;--status-warn-ink:#92400e;
  --status-hold-bg:#f1f5f9;--status-hold-ink:#334155;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:var(--beige);
  color:var(--ink);
  font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif;
  line-height:1.4;
}
img{max-width:100%;display:block}
a{color:inherit;text-decoration:none}

/* Utilities */
.container{max-width:1280px;margin:0 auto;padding:24px 20px}
.flex{display:flex}.items-center{align-items:center}.justify-between{justify-content:space-between}
.text-center{text-align:center}

/* Reveal-on-mount */
.reveal{opacity:0;transform:translateY(14px) scale(.99);will-change:opacity,transform;transition:opacity .6s cubic-bezier(.2,.8,.2,1), transform .6s cubic-bezier(.2,.8,.2,1)}
.reveal.is-visible{opacity:1;transform:none}

/* ===============================
   App Header (safe generic)
=============================== */
.header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:14px}
.h1{font-weight:700}

/* Optional sticky header (if using <header>) */
header{
  position:sticky;top:0;z-index:40;
  background:rgba(255,255,255,.7);
  -webkit-backdrop-filter:blur(6px);
  backdrop-filter:blur(6px);
  border-bottom:1px solid #e5e5e5;
}
header .logo{display:flex;align-items:center;gap:12px}
header .logo-icon{width:36px;height:36px;border-radius:12px;background:#111;color:#fff;display:grid;place-items:center;font-weight:600}
header nav a{color:#555;transition:color .2s}
header nav a:hover{color:#000}

/* ===============================
   Buttons
=============================== */
.btn{
  appearance:none;
  border:1px solid var(--line);
  background:var(--card);
  color:var(--ink);
  padding:10px 14px;
  border-radius:10px;
  font-size:14px;
  cursor:pointer;
  transition:all .15s;
  display:inline-flex;align-items:center;gap:8px;
}
.btn:hover{transform:translateY(-1px);box-shadow:0 6px 16px rgba(0,0,0,.06)}
.btn.primary{background:var(--btn);color:var(--btn-text);border-color:var(--btn)}
.btn.success{background:#10b981;color:#fff;border-color:#10b981}
.btn.danger{background:#ef4444;color:#fff;border-color:#ef4444}
.btn.small{padding:6px 10px;font-size:12px}
.btn.tiny{padding:4px 6px;font-size:12px}
.btn.icon{padding:8px;border-radius:999px;min-width:36px;justify-content:center}

/* Native button fallback */
button{cursor:pointer;border:none;border-radius:10px;font-size:13px;transition:all .2s}
button.primary{background:#111;color:#fff;padding:8px 14px}
button.primary:hover{background:#333}
button.secondary{background:#fff;border:1px solid #ccc;padding:8px 14px}
button.secondary:hover{background:#f9f9f9}

/* ===============================
   Fields / Inputs
=============================== */
.field{display:grid;gap:6px;margin-bottom:12px}
.field label{color:var(--muted);font-size:12px}
.field input,.field select{
  width:100%;padding:10px 12px;border:1px solid var(--line);
  border-radius:10px;background:var(--card);color:var(--ink);font-size:14px
}
.field.compact{min-width:140px;max-width:200px}
.compact-input{width:100%;padding:8px 10px;border:1px solid var(--line);border-radius:10px;background:var(--card);color:var(--ink);font-size:13px}
.search-input{width:260px;max-width:100%;padding:10px 12px;border:1px solid var(--line);border-radius:10px;background:#fff;color:var(--ink);font-size:14px}

/* Focus ring */
.btn:focus,.field input:focus,.field select:focus{outline:2px solid #1f6feb;outline-offset:2px}

/* ===============================
   Cards
=============================== */
.card{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:var(--radius);
  padding:18px;
  box-shadow:var(--shadow);
  margin:16px 0;
  position:relative;
}
.card-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;padding-bottom:10px;border-bottom:1px solid var(--line)}
.card-header h3,.card-header h2{margin:0;font-size:18px}

/* Pills / Badges */
.pill{display:inline-block;padding:6px 10px;border-radius:999px;background:var(--pill);border:1px solid var(--line);font-size:12px}
.pill-muted{background:#eef2ff;color:#3730a3}
.badge{display:inline-block;padding:4px 8px;border-radius:8px;background:var(--pill);border:1px solid var(--line);font-size:12px;color:var(--muted);margin-right:8px}

/* ===============================
   Catalog (safe overrides)
=============================== */
.catalog-section{background:var(--card);border:1px solid var(--line);border-radius:var(--radius);padding:18px;box-shadow:var(--shadow);margin-top:16px}
.catalog-header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:14px}
.catalog-controls{display:flex;align-items:center;gap:8px;flex-wrap:wrap}

.project-anchors{display:flex;gap:6px;flex-wrap:wrap;margin:8px 0 12px}
.pill.link{cursor:pointer;border-style:dashed;background:#fff}
.pill.link:hover{background:#f9fafb}

.catalog-list{display:block}
.project-card{background:#fff;border:1px solid var(--line);border-radius:12px;padding:16px;margin-bottom:14px;box-shadow:var(--shadow)}
.project-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;padding-bottom:10px;border-bottom:1px solid var(--line)}
.project-header h3{margin:0;font-size:18px;color:var(--ink)}
.project-actions{display:flex;gap:6px;flex-wrap:wrap}

/* Catalog tables */
.table-wrap{border-radius:12px;overflow:hidden}
.catalog-table{
  width:100%;
  border-collapse:separate;
  border-spacing:0;
  background:rgba(255,255,255,.9);
  border:1px dashed #ccc;
  border-radius:16px;
  overflow:hidden;
}
.catalog-table th,.catalog-table td{padding:12px;text-align:left;white-space:nowrap}
.catalog-table th{font-weight:500;font-size:13px;background:#f5f5f5;border-bottom:1px solid #e5e7eb}
.catalog-table tr + tr td{border-top:1px solid #e5e7eb}

/* Status pills (catalog rows) */
.status-pill{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500}
.status-available{background:var(--status-ok-bg);color:var(--status-ok-ink)}
.status-reserved{background:var(--status-warn-bg);color:var(--status-warn-ink)}
.status-hold{background:var(--status-hold-bg);color:var(--status-hold-ink)}

/* Catalog media cards */
.masterplan-card{display:block;background:#fff;border:1px solid var(--line);border-radius:12px;padding:12px}
.masterplan-card .label{margin-top:8px;color:var(--muted);font-size:12px}

/* ===============================
   Calculator
=============================== */
.top-section{display:flex;gap:20px;align-items:flex-start}
.stages-card{flex:1;min-width:0}
.settings-card{flex:1;min-width:0}
@media (max-width: 900px){.top-section{flex-direction:column}}

/* Calc: tables common */
.calc-scroll{overflow:auto;border:1px solid var(--line);border-radius:12px;background:var(--card)}
.calc-table{min-width:1000px;width:100%;border-collapse:separate;border-spacing:0}
.calc-table th{position:sticky;top:0;background:#faf9f5;border-bottom:2px solid var(--line);padding:12px 10px;font-weight:600;font-size:12px}
.calc-table td{padding:10px;border-bottom:1px solid var(--line);text-align:center}
.base-strong,.line-total{font-weight:600;color:#1f6feb}

/* Range (До ключей, %) */
input[type="range"].range{ -webkit-appearance:none; appearance:none; width:100%; height:6px; background:#e7e2d8; border-radius:999px; outline:none }
input[type="range"].range::-webkit-slider-thumb{ -webkit-appearance:none; appearance:none; width:18px; height:18px; border-radius:50%; background:#1f2937; cursor:pointer; border:2px solid #fff; box-shadow:0 1px 3px rgba(0,0,0,.25) }
input[type="range"].range::-moz-range-thumb{ width:18px; height:18px; border-radius:50%; background:#1f2937; cursor:pointer; border:2px solid #fff; box-shadow:0 1px 3px rgba(0,0,0,.25) }
input[type="range"].range::-moz-range-track{ height:6px; background:#e7e2d8; border-radius:999px }

/* KPI block */
.kpi-header-pills{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px}
.kpis{display:grid;grid-template-columns:repeat(auto-fit,minmax(210px,1fr));gap:12px}
.kpi{border:1px solid var(--line);border-radius:12px;padding:14px;background:#fff;display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:86px}
.kpi .muted{font-size:12px;color:var(--muted);margin-bottom:6px}
.kpi .v{font-size:16px;font-weight:700;color:#1f6feb}
.kpi.kpi-pair{gap:8px}
.kpi.kpi-pair .pair-item{width:100%;padding:4px 0;display:flex;flex-direction:column;align-items:center}
.kpi.kpi-pair .pair-item:not(:last-child){border-bottom:1px solid var(--line)}

/* Cashflow / factors tables */
.cashflow-scroll{overflow:auto;border:1px solid var(--line);border-radius:12px}
.factors-table{min-width:900px;width:100%;border-collapse:separate;border-spacing:0}
.factors-table th{position:sticky;top:0;background:#faf9f5;border-bottom:2px solid var(--line);padding:10px;font-weight:600;font-size:12px}
.factors-table td{padding:9px;border-bottom:1px solid var(--line);text-align:center}
.price-cell,.total-capital-cell,.rental-cell{font-weight:600;color:#0f172a}
.payment-cell{background:rgba(31,111,235,.06);font-weight:600;color:#1f6feb}
.positive{color:#dc2626;font-weight:600}
.negative{color:#16a34a;font-weight:600}

/* Stages table / scroll */
.stages-scroll{max-height:320px;overflow:auto}
.factors-table-container{border:1px solid var(--line);border-radius:12px;margin:16px 0;overflow:hidden}
.factors-table-scroll{overflow:auto}

/* Chart */
.pricing-chart-container{border:1px solid var(--line);border-radius:12px;padding:14px;background:#fff;margin-top:10px}
.pricing-chart-svg{border:1px solid var(--line);border-radius:12px;background:#faf9f5}

/* ===============================
   Modals
=============================== */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.5);-webkit-backdrop-filter:blur(6px);backdrop-filter:blur(6px);display:flex;align-items:center;justify-content:center;z-index:1000}
.modal-content{background:#fff;border:1px solid var(--line);border-radius:16px;max-width:90vw;max-height:80vh;overflow:auto;padding:18px;box-shadow:0 25px 50px -12px rgba(0,0,0,.25)}
.catalog-grid{max-height:400px;overflow:auto}
.project-group{margin-bottom:12px}
.villa-item{display:flex;align-items:center;justify-content:space-between;border:1px solid var(--line);border-radius:12px;padding:10px;background:#fff;margin-bottom:8px;cursor:pointer}
.villa-item:hover{background:#1f6feb;color:#fff;border-color:#1f6feb}
.villa-info{display:flex;flex-direction:column;gap:4px}

/* Misc / helpers */
.row{display:flex;gap:12px;align-items:flex-end;flex-wrap:wrap}
.info-display{padding:10px 12px;border:1px solid var(--line);border-radius:10px;background:#faf9f5}
.export-buttons{display:flex;gap:8px;flex-wrap:wrap}
.divider-line{width:80%;height:1px;background:var(--line);opacity:.5;margin:6px auto}
.adaptive-text{font-size:clamp(10px,2.5vw,12px);line-height:1.2;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%}

/* Hovers */
.calc-table tr:hover td,.factors-table tr:hover td{background:#faf9f5}

/* Scrollbars */
::-webkit-scrollbar{width:8px;height:8px}
::-webkit-scrollbar-track{background:#f5f2ea;border-radius:8px}
::-webkit-scrollbar-thumb{background:#d9d3c7;border-radius:8px}
::-webkit-scrollbar-thumb:hover{background:#cfc8ba}

/* Responsive finetune */
@media (max-width: 768px){
  .kpis{grid-template-columns:repeat(2, minmax(0,1fr))}
  .calc-table{min-width:820px}
  .catalog-header{flex-direction:column;align-items:flex-start;gap:8px}
  .search-input{width:100%}
  .project-actions{gap:8px}
}
@media (max-width: 480px){
  .kpis{grid-template-columns:1fr}
}

/* Print (for PDF clarity) */
@media print{
  body{background:#fff}
  .btn,.project-anchors,.catalog-controls{display:none!important}
  .project-card,.catalog-table,.card{box-shadow:none!important;border-color:#e5e7eb}
  .catalog-table{border:1px solid #e5e7eb}
  .calc-table th,.factors-table th{background:#f5f5f5!important}
}
